

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CSS瀑布流布局</title>
</head>
<body>
    <div id="main">
        <div class="box">
            <div class="pic">
                <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_07.jpg" alt="">
            </div>
        </div>
        <div class="box">
            <div class="pic">
                <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_06.jpg" alt="">
            </div>
        </div>
        <div class="box">
            <div class="pic">
                <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_09.jpg" alt="">
            </div>
        </div>

        <div class="box">
            <div class="pic">
                <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_011.jpg" alt="">
            </div>
        </div>

        <div class="box">
            <div class="pic">
                <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_010.jpg" alt="">
            </div>
        </div>

        <div class="box">
            <div class="pic">
                <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_015.jpg" alt="">
            </div>
        </div>

        <div class="box">
            <div class="pic">
                <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_014.jpg" alt="">
            </div>
        </div>

        <div class="box">
            <div class="pic">
                <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_013.jpg" alt="">
            </div>
        </div>

        <div class="box">
            <div class="pic">
                <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_012.jpg" alt="">
            </div>
        </div>

        <div class="box">
            <div class="pic">
                <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_017.jpg" alt="">
            </div>
        </div>
        
        <div class="box">
            <div class="pic">
                <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_016.jpg" alt="">
            </div>
        </div>

        <div class="box">
            <div class="pic">
                <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_019.jpg" alt="">
            </div>
        </div>
        
        <div class="box">
            <div class="pic">
                <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_018.jpg" alt="">
            </div>
        </div>
        
        <div class="box">
            <div class="pic">
                <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_00.jpg" alt="">
            </div>
        </div>
        
        <div class="box">
            <div class="pic">
                <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_01.jpg" alt="">
            </div>
        </div>
        
        <div class="box">
            <div class="pic">
                <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_010.jpg" alt="">
            </div>
        </div>
        
        <div class="box">
            <div class="pic">
                <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_011.jpg" alt="">
            </div>
        </div>


        <div class="box">
            <div class="pic">
                <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_013.jpg" alt="">
            </div>
        </div>

        <div class="box">
            <div class="pic">
                <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_012.jpg" alt="">
            </div>
        </div>




            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_07.jpg" alt="">
                </div>
            </div>
            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_06.jpg" alt="">
                </div>
            </div>
            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_09.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_011.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_010.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_015.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_014.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_013.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_012.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_017.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_016.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_019.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_018.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_00.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_01.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_010.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_011.jpg" alt="">
                </div>
            </div>


            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_013.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_012.jpg" alt="">
                </div>
            </div>

            <div class="box">
            <div class="pic">
                <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_017.jpg" alt="">
            </div>
        </div>


            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_013.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_012.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_017.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_016.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_019.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_018.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_00.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_01.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_010.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_011.jpg" alt="">
                </div>
            </div>


            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_013.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_012.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_017.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_013.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_012.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_017.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_016.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_019.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_018.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_00.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_01.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_010.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_011.jpg" alt="">
                </div>
            </div>


            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_013.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_012.jpg" alt="">
                </div>
            </div>

            <div class="box">
                <div class="pic">
                    <img src="http://7xrbku.com1.z0.glb.clouddn.com/P_017.jpg" alt="">
                </div>
            </div>

        </div>
</body>
<style>
*{
    margin:0;
    padding:0;}

    #main{
        position: relative;
    }
    .box{padding: 15px 0 0 15px;
        float: left;}

    .pic{
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
        box-shadow: 0 0 5px #ccc;

    }
    .pic img{
        width: 165px;
        height: auto;
    }
</style>
<script>
    window.onload=function () {
        waterfall('main','box')
    }
    function waterfall(parent,box) {
        //将main下的所有class为box的元素取出来
        var oParent=document.getElementById(parent)
        var oBoxs=getByClass(oParent,box)

        //计算整个页面显示的列数（页面宽的box的宽度)

        var oBoxW=oBoxs[0].offsetWidth
        var cols=Math.floor(document.documentElement.clientWidth/oBoxW)
        oParent.style.cssText='width:'+oBoxW*cols+'px;margin:0 auto';

      var hArr=[]
      for(var i=0;i<oBoxs.length;i++){
          if(i<cols){
              hArr.push(oBoxs[i].offsetHeight)
          }else{
              var minH=Math.min.apply(null,hArr)
       var index=getMinhIndex(hArr,minH);
              oBoxs[i].style.position='absolute'
              oBoxs[i].style.top=minH+'px'
              oBoxs[i].style.left=oBoxs[index].offsetLeft+'px'
              hArr[index]+=oBoxs[i].offsetHeight
          }
      }
function getMinhIndex(arr,val) {
    for(var i in arr){
        if(arr[i]==val){
            return i
        }
    }
    
}

    }
    //根据class获取元素
    function getByClass(parent,clsName) {
        //用来存储获取到的所有class为box的元素
        var boxArr=new Array()
        oElements=parent.getElementsByTagName('*')
        for(var i=0;i<oElements.length;i++){
            if(oElements[i].className==clsName){
                boxArr.push(oElements[i])

            }
        }
        return boxArr

    }

</script>
</html>
